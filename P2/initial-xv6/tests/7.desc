checking return value with properly initialized buffer but fd has been closed before getfilename is called